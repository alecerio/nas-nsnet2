#include <stdio.h>
#include "q_nsnet2.h"

static float x[257] = {
     1.92691537e-03,  1.48728408e-03,  9.00717219e-04, -2.10552104e-03,
     6.78418495e-04, -1.23454491e-03, -4.30674809e-05, -1.60466705e-03,
    -7.52135296e-04,  1.64872303e-03, -3.92478658e-04, -1.40360720e-03,
    -7.27881328e-04, -5.59430220e-04, -7.68838916e-04,  7.62445445e-04,
     1.64231705e-03, -1.59597475e-04, -4.97397559e-04,  4.39589290e-04,
    -7.58131209e-04,  1.07831764e-03,  8.00800626e-04,  1.68062060e-03,
     1.27912441e-03,  1.29642291e-03,  6.10466523e-04,  1.33473787e-03,
    -2.31624334e-04,  4.17594929e-05, -2.51575315e-04,  8.59858526e-04,
    -1.38467376e-03, -8.71236203e-04, -2.23365932e-04,  1.71736151e-03,
     3.18880338e-04, -4.24519007e-04,  3.05720954e-04, -7.74592569e-04,
    -1.55757251e-03,  9.95636103e-04, -8.79785861e-04, -6.01142063e-04,
    -1.27415126e-03,  2.12278520e-03, -1.23465317e-03, -4.87913901e-04,
    -9.13823023e-04, -6.58137316e-04,  7.80238770e-05,  5.25808777e-04,
    -4.87991754e-04,  1.19136914e-03, -8.14007653e-04, -7.35992799e-04,
    -1.40324794e-03,  3.60036684e-05, -6.34772732e-05,  6.75614923e-04,
    -9.78069002e-05,  1.84459414e-03, -1.18453742e-03,  1.38354942e-03,
     1.44513382e-03,  8.56412575e-04,  2.21807580e-03,  5.23165567e-04,
     3.46646673e-04, -1.97331450e-04, -1.05458894e-03,  1.27799565e-03,
    -1.72190135e-04,  5.23788505e-04,  5.66218223e-05,  4.26296174e-04,
     5.75005077e-04, -6.41724153e-04, -2.20639864e-03, -7.50803098e-04,
     1.08681452e-05, -3.38742364e-04, -1.34067959e-03, -5.85370581e-04,
     5.36188134e-04,  5.24622621e-04,  1.14120170e-03,  5.16435975e-05,
     7.43951998e-04, -4.81584430e-04, -1.04946620e-03,  6.03898836e-04,
    -1.72229507e-03, -8.27768876e-04,  1.33470306e-03,  4.83539305e-04,
    -2.50954460e-03,  4.88001067e-04,  7.84586882e-04,  2.86471877e-05,
     6.40755345e-04,  5.83247456e-04,  1.06692675e-03, -4.50153399e-04,
    -1.85267490e-04,  7.52758875e-04,  4.04757826e-04,  1.78465998e-04,
     2.64909526e-04,  1.27316837e-03, -1.31086369e-06, -3.03603796e-04,
    -1.45702914e-03, -1.02335245e-04, -5.99153049e-04,  4.77056426e-04,
     7.26177241e-04,  9.11518655e-05, -3.89065215e-04,  5.27916534e-04,
    -1.26854793e-05,  2.40836336e-04,  1.32535381e-04,  7.64240685e-04,
     1.09500973e-03,  3.39890976e-04,  7.19967531e-04,  4.11407644e-04,
     1.93116069e-03,  1.01186393e-03, -1.43640651e-03, -1.12985983e-03,
    -1.36034534e-04,  1.63540966e-03,  6.54740783e-04,  5.76004619e-04,
     1.14150799e-03,  1.85645767e-05, -1.80580514e-03,  9.25434928e-04,
    -3.75344389e-04,  1.03308738e-03, -6.86650979e-04,  6.36813696e-04,
    -9.72673937e-04,  9.58457822e-04,  1.61920057e-03,  1.45060988e-03,
     2.69481563e-04, -2.10375991e-04, -7.32802786e-04,  1.04297840e-04,
     3.48751724e-04,  9.67594213e-04, -4.65688470e-04,  1.60479732e-03,
    -2.48012040e-03, -4.17543750e-04, -1.19545381e-03,  8.12336977e-04,
    -1.90055335e-03,  2.28576537e-04,  2.48594060e-05, -3.45950277e-04,
     2.86832830e-04, -7.30842468e-04,  1.74820263e-04, -1.09392940e-03,
    -1.60216040e-03,  1.35289703e-03,  1.28882774e-03,  5.22954761e-05,
    -1.54685054e-03,  7.56706111e-04,  7.75519526e-04,  2.02653557e-03,
     3.58176148e-05,  1.20588731e-04, -8.05663760e-04, -2.07576843e-04,
    -9.31947900e-04, -1.59096625e-03, -1.13597582e-03, -5.22597635e-04,
    -5.18773333e-04, -1.50127639e-03, -1.92665437e-03,  1.27851235e-04,
     1.02291338e-03, -5.55795152e-04,  7.04272767e-04,  7.09876011e-04,
     1.77438848e-03, -9.21551022e-04,  9.62449936e-04, -3.37015168e-04,
    -1.17533363e-03,  3.58057092e-04,  4.78767935e-04,  1.35370006e-03,
     5.26062096e-04,  2.11203797e-03, -5.20757167e-04, -9.32006165e-04,
     1.85161349e-04,  1.06869196e-03,  1.30653451e-03,  4.59834526e-04,
    -8.14626925e-04, -1.02123932e-03, -4.94923559e-04, -5.92251658e-04,
     1.54315960e-04,  4.40767093e-04, -1.48292311e-04, -2.31844350e-03,
    -3.97995347e-04,  1.08048634e-03, -1.78086443e-03,  1.50804548e-03,
     3.09428549e-04, -5.00309048e-04,  1.03500322e-03,  1.68964721e-03,
    -4.50505195e-06,  1.66679244e-03,  1.53920177e-04, -1.06025313e-03,
    -5.72657620e-04,  8.35680403e-05,  3.99905373e-04,  1.98920723e-03,
    -7.19875097e-05, -9.06094559e-04, -2.04871246e-03, -1.08105561e-03,
     1.76230806e-05,  7.82259885e-05,  1.93158310e-04,  4.09673434e-04,
    -9.29130358e-04,  5.63559006e-04, -1.50717515e-03, -1.61066616e-03,
    -1.47904665e-03,  4.32274304e-04, -1.25025414e-04,  7.82118412e-04,
     5.63508831e-04, -1.09129956e-04,  7.15199509e-04,  3.91392241e-05,
     1.30586023e-03,  2.46592768e-04, -1.97759108e-03,  1.78960436e-05,
    -1.41287665e-03,
};


int main() {
    int flag;
    char* weights_path = "/home/alessandro/Desktop/nas-nsnet2/nsnet2/pytorch/numpy_weights/";
    flag = setup_nsnet2(weights_path);
    if(flag != 0) {
        printf("Error in nsnet2 initialization\n");
        return -1;
    }
    run_nsnet2(x, 0, 0);
    free_nsnet2();
    return 0;
}